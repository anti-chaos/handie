!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.handie=t()}(this,function(){"use strict";function e(){var e=$(".modal:visible .js-waitForResult:visible");e.size()&&(e.hide(),$("button",$(".modal-header, .modal-footer",e.closest(".modal"))).prop("disabled",!1))}function t(t,n,a,r,o){var i={url:t,type:n,success:function(t){e(),d.ajax.result(t,function(e){$.isFunction(r)&&r.call(null,e,t)})}};return o===!0?(i.data=JSON.stringify(a),i.contentType="application/json; charset=UTF-8"):["get","delete"].includes(n)?i.url+="?"+Object.keys(a).map(function(e){return e+"="+encodeURIComponent(a[e])}).join("&"):i.data=a,$.ajax(i)}function n(e,t){var n=void 0,a=void 0,r=void 0,o=void 0;return e=e.toString(10),t=t.toString(10),n=e.split("."),a=t.split("."),r=2===n.length?n[1].length:0,o=2===a.length?a[1].length:0,Math.max(r,o)}function a(e,t){var n=void 0,a=void 0;if(0===t)return e;e=e.toString(10),a=e.split("."),n=a[1]?a[1]:"",a=a[0];for(var r=0;t>r;r++)a+=n[r]?n[r]:"0";return 1*a}function r(e,t){if(0===t)return e;var n=void 0,a=void 0;e=e.toString(),n=e.split("."),2===n.length&&(t+=n[1].length,e=e.replace(".","")),n=e.split(""),a=e.length;for(var r=0;t-a>r;r++)n.unshift("0");return n.splice(n.length-t,0,"."),1*n.join("")}function o(e){var t=void 0;return $("option",e).each(function(){return this.defaultSelected===!0?(t=$(this),!1):void 0}),t||$("option:first",e)}function i(){return $(u.table.selector)}function s(){[{dependency:f.BS_MODAL,initializer:function(){$.extend($.fn.modal.Constructor.DEFAULTS,{backdrop:"static",keyboard:!1})}},{dependency:f.BS_TABLE,initializer:function(){$.extend($.fn.bootstrapTable.defaults,{classes:"table table-condensed table-hover",iconsPrefix:"fa",sidePagination:"server",pagination:!0,pageSize:20,pageList:[],queryParams:function(e){return e={},$(".Area--query form").serializeArray().concat({name:"pageSize",value:this.pageSize},{name:"pageNo",value:this.pageNumber}).forEach(function(t){e[t.name]=t.value}),e},responseHandler:function(e){return u.table.responseHandler.call(this,e)}}),$.extend($.fn.bootstrapTable.columnDefaults,{valign:"middle"})}},{dependency:f.SELECT2,initializer:function(){$.each({containerCssClass:"handie-Select2-container",dropdownCssClass:"handie-Select2-dropdown",minimumResultsForSearch:"Infinity"},function(e,t){$.fn.select2.defaults.set(e,t)})}},{dependency:f.H5FX,initializer:function(){H5F.rules({MOBILE:{rule:/^(0|86|17951)?(13[0-9]|15[012356789]|17[03678]|18[0-9]|14[57])[0-9]{8}$/,message:"NOT_A_MOBILE"}}),H5F.errors({UNKNOWN_INPUT_TYPE:"\u4e3a\u672a\u77e5\u8f93\u5165\u6846\u7c7b\u578b",COULD_NOT_BE_EMPTY:"\u4e0d\u80fd\u4e3a\u7a7a",LENGTH_SMALLER_THAN_MINIMUM:"\u5e94\u4e3a\uff5e\u4e2a\u5b57\u7b26",LENGTH_BIGGER_THAN_MAXIMUM:"\u5e94\u4e3a\uff5e\u4e2a\u5b57\u7b26",INVALID_VALUE:"\u65e0\u6548\u5b57\u7b26",NOT_AN_ABSOLUTE_URL:"\u4e0d\u662f\u4e00\u4e2a URL \u5730\u5740",NOT_AN_EMAIL:"\u4e0d\u662f\u4e00\u4e2a\u90ae\u7bb1",NOT_A_NUMBER:"\u4e0d\u662f\u4e00\u4e2a\u6570\u5b57",UNDERFLOW:"\u4e0d\u80fd\u5c0f\u4e8e",OVERFLOW:"\u4e0d\u80fd\u5927\u4e8e",DIFFERENT_VALUE:"\u6240\u8f93\u5165\u7684\u5b57\u7b26\u8981\u4e0e\u4fdd\u6301\u4e00\u81f4",AT_LEAST_CHOOSE_ONE:"\u8bf7\u4ece\u4e2d\u9009\u62e9\u4e00\u9879",SHOOLD_BE_CHOSEN:"\u8bf7\u9009\u4e2d",SHOOLD_CHOOSE_AN_OPTION:"\u5fc5\u987b\u9009\u62e9",NOT_A_MOBILE:"\u4e0d\u7b26\u5408\u624b\u673a\u53f7\u7801\u683c\u5f0f"})}},{dependency:f.MOMENTJS,initializer:function(){moment.locale("zh-CN")}}].forEach(function(e){e.dependency&&e.initializer()})}function l(){f.BS_MODAL&&($(document).on("shown.bs.modal",".modal",function(){var e=$(this),t=$(".modal-dialog",e),n=$(".modal-content",e);d.dialog.levelUp(e),t.height()>e.height()&&(e.addClass("is-scrollable"),n.css("height",e.height()-parseFloat(t.css("margin-top"),10)-parseFloat(t.css("margin-bottom"),10)-parseFloat(n.css("border-top-width"),10)-parseFloat(n.css("border-bottom-width"),10)))}),$(document).on("hidden.bs.modal",".modal",function(){var e=$(this);d.dialog.levelDown(e),e.hasClass("is-scrollable")&&(e.removeClass("is-scrollable"),$(".modal-content",e).css("height","auto"))}))}function c(){f.SELECT2&&($("select").select2(),$(".modal select").on("select2:open",function(){$(this).data("select2").$dropdown.css("z-index",$(this).closest(".modal").css("z-index"))}))}var u={},d={},f={BS_MODAL:$.fn.hasOwnProperty("modal"),BS_TABLE:$.fn.hasOwnProperty("bootstrapTable"),SELECT2:$.fn.hasOwnProperty("select2"),H5FX:window.hasOwnProperty("H5F"),MOMENTJS:window.hasOwnProperty("moment")};d.setDefaults=function(e){$.extend(!0,u,e)},d.$el={triggerType:function(e){return e.attr("class").match(/js\-([a-zA-Z]+)/)[1]}},u.ajax={errorHandler:function(e,t,n,a){var r=t.status;r>=500?alert("\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566\uff5e"):r>=400&&alert(t.responseText)},responseHandler:function(e,t){t(null,e)}},d.ajax={get:function(t,n,a){return $.isFunction(n)&&(a=n,n={}),$.getJSON(t,n,function(t){e(),d.ajax.result(t,function(e){$.isFunction(a)&&a.call(null,e,t)})})},result:function(){var e;(e=u.ajax).responseHandler.apply(e,arguments)},waiting:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u6570\u636e\u4fdd\u5b58\u4e2d\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85...",n=e.closest(".modal");n.size()&&($(".js-waitForResult",n).size()?$(".js-waitForResult",n).show():$(".modal-body",n).append('<div class="Layer Layer--loading js-waitForResult"><p>'+t+"</p></div>"),$("button",$(".modal-header, .modal-footer",n)).prop("disabled",!0))}},["post","put","delete"].forEach(function(e){d.ajax[e]=function(n,a,r,o){return t(n,e,a,r,o)}}),d.calculate={plus:function(e,t){var o=n(e,t);return r(a(e,o)+a(t,o),o)},minus:function(e,t){var o=n(e,t);return r(a(e,o)-a(t,o),o)},multiply:function(e,t){var o=n(e,t);return r(a(e,o)*a(t,o),2*o)},divided:function(e,t){var o=n(e,t);return r(a(e,o)/a(t,o),o)},move2Left:r,move2Right:a,getMoveDigit:n};var p=0,m=1050;return f.BS_MODAL&&(d.dialog={levelUp:function(e){var t=e.data("bs.modal").$backdrop,n=2*p*10;e.css("z-index",m+n),t&&t.css("z-index",m+n-10),p++},levelDown:function(e){var t=e.data("bs.modal").$backdrop;e.css("z-index",m),t&&t.css("z-index",m-10),p--},top:function(){return[].sort.call($(".modal:visible"),function(e,t){return 1*$(e).css("z-index")<1*$(t).css("z-index")}).first()}}),d.select={change:function(e,t,n){var a=null==t||""===t?o(e):$("option[value='"+t+"']",e);return a.prop("selected",!0).siblings(":selected").prop("selected",!1),$.isFunction(n)&&n.call(e.get(0)),e.trigger("change"),e}},d.form={fill:function(e,t){$("[name]",e).each(function(){var n=$(this),a=this.tagName.toLowerCase(),r=n.attr("name"),o=t[r];["input","textarea"].includes(a)?["radio","checkbox"].includes(n.attr("type"))?$('[name="'+r+'"][value="'+o+'"]',e).prop("checked",!0):n.val(o):"select"===a&&d.select.change(n,o)})},reset:function(e,t){$("select",e).each(function(){d.select.change($(this))}),$("[type='hidden']").val(""),$.isFunction(t)&&t.call(e.get(0))}},f.H5FX&&(d.form.h5f=function(e){H5F.init(e,{immediate:!1}),$("[name]",e).on({"H5F:valid":function(e,t){var n=$(e.target).closest("div"),a=$(".ErrorGroup",n);$(".Error[data-name='"+t.name+"']",n).remove(),0===$(".Error",a).size()&&a.remove()},"H5F:invalid":function(e,t){var n=$(e.target).closest("div"),a=$(".Error[data-name='"+t.name+"']",n);0===$(".ErrorGroup",n).size()&&n.append('<div class="ErrorGroup" />'),0===a.size()&&($(".ErrorGroup",n).append('<p class="Error" data-name="'+t.name+'" />'),a=$(".Error[data-name='"+t.name+"']",n)),a.text(t.message)}}),e.on("reset",function(){$(".ErrorGroup",e).remove()})}),d.field={fill:function(e,t,n){$("[data-field]",e).each(function(){var e=$(this),a=t[e.attr("data-field")];e.is("img")?e.attr("src",a):e.text(a||"-"),$.isFunction(n)&&n.apply(this,[e.attr("data-field"),a])})},datepicker:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(".js-pickDate"),t=arguments[1];e.each(function(){var e=$(this),n=$('[name="'+e.attr("data-to")+'"]',e.closest("form"));e.datepicker($.extend({language:"zh-CN",autohide:!0},n.size()?{pick:function(){n.val(moment($(this).datepicker("getDate")).format())}}:null,t)),n.size()&&e.on("change",function(){""===$(this).val()&&n.val("")})})}},d.generate={image:function(e,t){var n="";return t=t||"",t&&(n="<figcaption>"+t+"</figcaption>"),'<figure class="ImageItem"><a href="'+e+'" target="_blank"><img src="'+e+'" alt="'+t+'" title="'+t+'"></a>'+n+"</figure>"},action:function(e,t){if($.isPlainObject(e)&&(e=[e]),e=e.concat(u.table.rowActions),!Array.isArray(e))return!1;var n=e.map(function(e){if($.isPlainObject(e)){var t=[],n="btn btn-"+(e.isDelete===!0?"danger":"default")+" btn-xs js-"+e.action,a="string"===$.type(e.url);return a?t.push('<a href="'+e.url+'" class="'+n+'" title="'+e.text+'">'):t.push('<button type="button" class="'+n+'" title="'+e.text+'">'),t.push("string"===$.type(e.icon)?'<i class="fa fa-'+e.icon+'"></i><span class="sr-only">'+e.text+"</span>":e.text),t.push("</"+(a?"a":"button")+">"),t.join("")}return""});return(e.length>1||t===!0)&&(n.unshift('<div class="OperationGroup">'),n.push("</div>")),n.join("")}},u.table={selector:"",showRowNumber:!1,rowActions:[]},f.BS_TABLE&&(u.table.responseHandler=$.fn.bootstrapTable.defaults.responseHandler,d.table={init:function(e){e.columns=d.table.columns(e.columns,e.showRowNumber),i().bootstrapTable(e)},columns:function(e,t){var n=e.concat([]);return"boolean"!==$.type(t)&&(t=u.table.showRowNumber),t===!0&&n.unshift({field:"serialNumber",title:"\u5e8f\u53f7",align:"center",formatter:function(e,t,n){return++n}}),n.map(function(e){var t=e.viewDetail,n=e.dateTimeFormatter;return $.isPlainObject(t)?(e.formatter=function(e){return'<a href="javascript:void(0);" class="js-openDetailDialog">'+(e||"-")+"</a>"},e.events=$.extend({},e.events,{"click .js-openDetailDialog":function(e,n,a){$.getJSON(t.url,t.params(n,a),function(e){d.ajax.result(e,function(e){var r=$(".js-viewDetail");$.isFunction(t.handler)?t.handler.apply(null,[n,a,e,r]):d.field.fill(r,e),r.modal("show")})})}})):n&&(e.formatter=function(e){return n===!0&&(n="YYYY-MM-DD HH:mm:ss"),"string"===$.type(n)&&moment?moment(e).format(n):$.isFunction(n)?n.call(this,e):e}),e.titleTooltip=e.title,e})},refresh:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i(),t=arguments[1];"boolean"==typeof e&&(t=e,e=i()),t===!0&&(e.data("bootstrap.table").options.pageNumber=1),e.bootstrapTable("refresh")}}),$(document).ajaxError(function(){var t;(t=u.ajax).errorHandler.apply(t,arguments),e()}),$(document).ready(function(){s(),l(),c(),$("input[type='number']").on("mousewheel",function(e){e.preventDefault()})}),d});